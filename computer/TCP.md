# TCP
TCP协议的运行分为三个阶段
## 1. 连接创建(connection establishment)
TCP用*三次握手(three-way handshake)*过程创建一个连接。连接创建过程中，很多参数需要初始化来保证`按序`传输和连接的强壮型。  
通常是有一端打开一个`套接字(socket)`然后监听来自另一方的连接，这就是`被动打开(passive open)`。服务器端被被动打开之后，用户端就可以创建`主动打开(active open)`。
1. 客户端通过向客户端发送一个`SYN`来创建一个`主动打开`，作为三次握手的一部分。客户端将这段连接的序号设定为随机数A。
> `SYN`：同步序列编号(Synchronize Sequence Numbers)。是TCP/IP建立连接时使用的握手信号。
> `seq`：序列号
2. 服务器端应为一个合法的`SYN`回送一个`SYN/ACK`。`ACK`的确认码应为A+1，`SYN/ACK`包本身又有一个随机产生的序号B。
> `SYN/ACK`：服务器用来表示接收到了这个信息
3. 最后，客户端再发送一个`ACK`。此时包的序号被设定为`A+1`，而`ACK`的确认码则为B+1。当服务端收到这个`ACK`的时候，就完成了三次握手，并进入了连接创建状态。
## 2. 数据传送(data transfer)
### 可靠性&强壮性的措施
1. 使用序号，对收到的TCP报文段进行排序以及检测重复的数据；
2. 使用校验和检测报文段的错误，即无错传输；
3. 使用确认和计时器来检测和纠正丢包或延时；
4. 流控制(Flow control)；
5. 拥塞控制(congestion control)；
6. 丢失包的重传；

## 3. 连接终止(connection termination)
四次挥手：
1. 主动关闭方发送一个`FIN`，序号设定为随机数C，用来关闭主动放到被动关闭方的数据传输。*此时主动关闭方还可以接受数据*。(如果`FIN`之前发送的数据，没有收到对应的`ACK`确认报文，则主动方依旧回重发这些数据)。
2. 被动关闭方接受到`FIN`之后，发送一个`ACK`给对方，确认序号为收到序号C+1。
3. 被动关闭方发送一个`FIN`，用来关闭被动关闭方到主动关闭方的数据传送，序号设定为随机数D。
4. 主动关闭方收到`FIN`之后，发送一个`ACK`给被动关闭方，确认序号为D+1，完成四次挥手。

# 浏览器中输入URL之后执行的过程
访问www.domain.com
1. 